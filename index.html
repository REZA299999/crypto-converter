<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CryptoXchanger</title>
  <style>
    body {
      background-color: #111;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    h1 {
      color: #00f7c4;
    }
    select,
    input {
      padding: 10px;
      margin: 10px;
      background-color: #222;
      color: #fff;
      border: 1px solid #444;
      border-radius: 5px;
    }
    img.icon {
      width: 24px;
      vertical-align: middle;
      margin-right: 5px;
    }
    #loading {
      font-style: italic;
      color: #888;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>ðŸ’± <span style="color: #00f7c4">CryptoXchanger</span></h1>
  <p id="desc">Konversi crypto populer secara real-time</p>

  <div>
    <label id="labelFrom">
      Dari:<br />
      <img id="iconFrom" class="icon" src="" alt="icon" />
      <select id="fromCurrency"></select>
    </label>
  </div>

  <div>
    <label id="labelTo">
      Ke:<br />
      <img id="iconTo" class="icon" src="" alt="icon" />
      <select id="toCurrency"></select>
    </label>
  </div>

  <div>
    <label id="labelAmount">
      Jumlah:<br />
      <input type="number" id="amount" value="1" min="0" />
    </label>
  </div>

  <h2 id="result">Masukkan jumlah untuk melihat hasil...</h2>
  <div id="loading" style="display:none;">Memuat data...</div>

  <script>
    // Data terjemahan
    const translations = {
      id: {
        title: "Konversi crypto populer secara real-time",
        from: "Dari",
        to: "Ke",
        amount: "Jumlah",
        inputValid: "Masukkan jumlah valid...",
        loading: "Memuat data...",
        failed: "Gagal mengambil data.",
        resultPrefix: "",
        resultSuffix: ""
      },
      en: {
        title: "Popular crypto conversion in real-time",
        from: "From",
        to: "To",
        amount: "Amount",
        inputValid: "Enter a valid amount...",
        loading: "Loading data...",
        failed: "Failed to fetch data.",
        resultPrefix: "",
        resultSuffix: ""
      }
    };

    // Deteksi bahasa browser
    const userLang = navigator.language || navigator.userLanguage;
    const lang = userLang.slice(0, 2);
    const texts = translations[lang] || translations["en"];

    // Update UI teks berdasarkan bahasa
    document.getElementById("desc").textContent = texts.title;
    document.getElementById("labelFrom").childNodes[0].textContent = texts.from + ":";
    document.getElementById("labelTo").childNodes[0].textContent = texts.to + ":";
    document.getElementById("labelAmount").childNodes[0].textContent = texts.amount + ":";
    document.getElementById("result").textContent = texts.inputValid;

    const supportedCoins = [
      { id: "bitcoin", symbol: "BTC" },
      { id: "ethereum", symbol: "ETH" },
      { id: "litecoin", symbol: "LTC" },
      { id: "solana", symbol: "SOL" },
      { id: "tether", symbol: "USDT" },
      { id: "polygon", symbol: "MATIC" },
      { id: "binancecoin", symbol: "BNB" },
      { id: "arbitrum", symbol: "ARB" },
      { id: "optimism", symbol: "OP" },
      { id: "base", symbol: "BASE" }
    ];

    const iconMap = {
      bitcoin: "https://cryptologos.cc/logos/bitcoin-btc-logo.png?v=026",
      ethereum: "https://cryptologos.cc/logos/ethereum-eth-logo.png?v=026",
      litecoin: "https://cryptologos.cc/logos/litecoin-ltc-logo.png?v=026",
      solana: "https://cryptologos.cc/logos/solana-sol-logo.png?v=026",
      tether: "https://cryptologos.cc/logos/tether-usdt-logo.png?v=026",
      polygon: "https://cryptologos.cc/logos/polygon-matic-logo.png?v=026",
      binancecoin: "https://cryptologos.cc/logos/binance-coin-bnb-logo.png?v=026",
      arbitrum: "https://cryptologos.cc/logos/arbitrum-arb-logo.png?v=026",
      optimism: "https://cryptologos.cc/logos/optimism-op-logo.png?v=026",
      base: "https://cryptologos.cc/logos/base-base-logo.png?v=026"
    };

    const fromSelect = document.getElementById("fromCurrency");
    const toSelect = document.getElementById("toCurrency");
    const iconFrom = document.getElementById("iconFrom");
    const iconTo = document.getElementById("iconTo");
    const amountInput = document.getElementById("amount");
    const resultText = document.getElementById("result");
    const loadingText = document.getElementById("loading");

    function populateSelects() {
      supportedCoins.forEach(coin => {
        const optionFrom = document.createElement("option");
        optionFrom.value = coin.id;
        optionFrom.textContent = coin.symbol;
        fromSelect.appendChild(optionFrom);

        const optionTo = document.createElement("option");
        optionTo.value = coin.id;
        optionTo.textContent = coin.symbol;
        toSelect.appendChild(optionTo);
      });

      fromSelect.value = "bitcoin";
      toSelect.value = "ethereum";
      updateIcons();
    }

    function updateIcons() {
      iconFrom.src = iconMap[fromSelect.value];
      iconTo.src = iconMap[toSelect.value];
    }

    async function convert() {
      const from = fromSelect.value;
      const to = toSelect.value;
      const amount = parseFloat(amountInput.value);

      if (!amount || amount <= 0) {
        resultText.textContent = texts.inputValid;
        return;
      }

      loadingText.style.display = "block";
      resultText.textContent = "";

      try {
        const res = await fetch(
          `https://api.coingecko.com/api/v3/simple/price?ids=${from}&vs_currencies=${to}`
        );
        const data = await res.json();
        const rate = data[from][to];

        const converted = rate * amount;
        resultText.textContent = `${amount} ${from.toUpperCase()} â‰ˆ ${converted.toFixed(6)} ${to.toUpperCase()}`;
      } catch (err) {
        resultText.textContent = texts.failed;
      } finally {
        loadingText.style.display = "none";
      }
    }

    populateSelects();
    convert();

    fromSelect.addEventListener("change", () => {
      updateIcons();
      convert();
    });
    toSelect.addEventListener("change", () => {
      updateIcons();
      convert();
    });
    amountInput.addEventListener("input", convert);
  </script>
</body>
</html>
